function setIconCallback(e){e&&e.runState?chrome.browserAction.setIcon({path:{16:"icons/gusmd16-active.png"}}):chrome.browserAction.setIcon({path:{16:"icons/gusmd16-idle.png"}})}var chrome=window.chrome,originalHTML={},lightningLocation="gus.lightning.force.com",validPagesRegex=/sObject\/\w{18}\/view|one.app#\w{488}/g,tabURLs={};chrome.browserAction.onClicked.addListener(function(){chrome.tabs.query({active:!0,currentWindow:!0},function(e){let n=e[0].url;n.indexOf(lightningLocation)>-1?null!==n.match(validPagesRegex)?chrome.tabs.sendMessage(e[0].id,{getCurrentRunState:!0,changeRun:!0,originalHTML:originalHTML[n]},function(e){setIconCallback(e)}):chrome.browserAction.setIcon({path:{16:"icons/gusmd16.png"}}):chrome.tabs.sendMessage(e[0].id,{getCurrentRunState:!0,changeRun:!0,originalHTML:originalHTML[n]},function(e){setIconCallback(e)})})}),chrome.tabs.onActivated.addListener(function(e){chrome.tabs.get(e.tabId,function(e){chrome.tabs.query({active:!0,currentWindow:!0},function(e){let n=e[0].url;n.indexOf(lightningLocation)>-1?null!==n.match(validPagesRegex)?chrome.tabs.sendMessage(e[0].id,{getCurrentRunState:!0},function(e){setIconCallback(e)}):chrome.browserAction.setIcon({path:{16:"icons/gusmd16.png"}}):chrome.tabs.sendMessage(e[0].id,{getCurrentRunState:!0},function(e){setIconCallback(e)})})})}),chrome.tabs.onUpdated.addListener(function(e,n,t){if("complete"==n.status){var a=!1;void 0!==tabURLs[e]&&tabURLs[e]!==t.url&&null!==t.url.match(validPagesRegex)&&(a=!0),null!==t.url.match(validPagesRegex)&&(tabURLs[e]=t.url),chrome.tabs.query({active:!0,currentWindow:!0},function(e){let n=e[0].url;n.indexOf(lightningLocation)>-1?null!==n.match(validPagesRegex)?!0===a?chrome.tabs.sendMessage(e[0].id,{getCurrentRunState:!0,init:!0,originalHTML:originalHTML[n]},function(e){setIconCallback(e)}):chrome.tabs.sendMessage(e[0].id,{getCurrentRunState:!0},function(e){setIconCallback(e)}):chrome.browserAction.setIcon({path:{16:"icons/gusmd16.png"}}):chrome.tabs.sendMessage(e[0].id,{getCurrentRunState:!0,originalHTML:originalHTML[n]},function(e){setIconCallback(e)})})}}),chrome.runtime.onMessage.addListener(function(e,n,t){e.originalHTML&&void 0===originalHTML[n.tab.url]&&(originalHTML[n.tab.url]=e.originalHTML),!0===e.alohaRedirect&&t({init:!0})});
