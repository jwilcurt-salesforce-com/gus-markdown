function setIconCallback(n){n&&n.runState?chrome.browserAction.setIcon({path:{16:"icons/gusmd16-active.png"}}):chrome.browserAction.setIcon({path:{16:"icons/gusmd16-idle.png"}})}var chrome=window.chrome,originalHTML={},lightningLocation="gus.lightning.force.com",tabURLs={};chrome.browserAction.onClicked.addListener(function(){chrome.tabs.query({active:!0,currentWindow:!0},function(n){let e=n[0].url;e.indexOf(lightningLocation)>-1?-1!=n[0].url.indexOf("view")||488==e.split("#")[1].length?chrome.tabs.sendMessage(n[0].id,{changeRun:!0,originalHTML:originalHTML[e]},function(n){setIconCallback(n)}):chrome.browserAction.setIcon({path:{16:"icons/gusmd16.png"}}):chrome.tabs.sendMessage(n[0].id,{changeRun:!0,originalHTML:originalHTML[e]},function(n){setIconCallback(n)})})}),chrome.tabs.onActivated.addListener(function(n){chrome.tabs.get(n.tabId,function(n){chrome.tabs.query({active:!0,currentWindow:!0},function(n){let e=n[0].url;e.indexOf(lightningLocation)>-1?-1!=e.indexOf("view")||488==e.split("#")[1].length?chrome.tabs.sendMessage(n[0].id,{getCurrentRunState:!0},function(n){setIconCallback(n)}):chrome.browserAction.setIcon({path:{16:"icons/gusmd16.png"}}):chrome.tabs.sendMessage(n[0].id,{getCurrentRunState:!0},function(n){setIconCallback(n)})})})}),chrome.tabs.onUpdated.addListener(function(n,e,t){if("complete"==e.status){var i;i=void 0!==tabURLs[n]&&tabURLs[n]!==t.url,tabURLs[n]=t.url,chrome.tabs.query({active:!0,currentWindow:!0},function(n){let e=n[0].url;e.indexOf(lightningLocation)>-1?-1!=e.indexOf("view")||488==e.split("#")[1].length?(console.log(i),!0===i?chrome.tabs.sendMessage(n[0].id,{getCurrentRunState:!0,init:!0,originalHTML:originalHTML[e]},function(n){setIconCallback(n)}):chrome.tabs.sendMessage(n[0].id,{getCurrentRunState:!0},function(n){setIconCallback(n)})):chrome.browserAction.setIcon({path:{16:"icons/gusmd16.png"}}):!0===i?chrome.tabs.sendMessage(n[0].id,{getCurrentRunState:!0,init:!0,originalHTML:originalHTML[e]},function(n){setIconCallback(n)}):chrome.tabs.sendMessage(n[0].id,{getCurrentRunState:!0},function(n){setIconCallback(n)})})}}),chrome.runtime.onMessage.addListener(function(n,e){n.iframe&&chrome.browserAction.setIcon({path:{16:"icons/gusmd16-active.png"}}),n.originalHTML&&void 0===originalHTML[e.tab.url]&&(originalHTML[e.tab.url]=n.originalHTML)});
